
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Running CTSM at University of Florida">
      
      
      
        <link rel="canonical" href="https://cdevaneprugh.github.io/hpg-esm-docs/swenson/merit-validation/">
      
      
        <link rel="prev" href="../pysheds-porting/">
      
      
        <link rel="next" href="../osbs-implementation/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>MERIT Validation - CTSM on HiPerGator</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#merit-dem-validation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CTSM on HiPerGator" class="md-header__button md-logo" aria-label="CTSM on HiPerGator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CTSM on HiPerGator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MERIT Validation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CTSM on HiPerGator" class="md-nav__button md-logo" aria-label="CTSM on HiPerGator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CTSM on HiPerGator
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onboarding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Onboarding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prerequisites
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/cime-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CIME Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/fork-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fork Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/mksurfdata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building mksurfdata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Running CTSM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Running CTSM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running-ctsm/case-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Case Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running-ctsm/single-point/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single-Point Runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running-ctsm/history-output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    History Output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running-ctsm/spinup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spinup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../running-ctsm/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Research
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Research
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/hillslope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hillslope Hydrology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../research/neon-sites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NEON Sites
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Swenson Implementation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Swenson Implementation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pysheds-porting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pysheds Porting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    MERIT Validation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    MERIT Validation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-1-pgrid-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 1: pgrid Validation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-2-fft-spatial-scale-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 2: FFT Spatial Scale Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-3-hillslope-parameter-computation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 3: Hillslope Parameter Computation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-4-initial-comparison-to-published-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 4: Initial Comparison to Published Data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-5-unit-conversion-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 5: Unit Conversion Fix
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-6-width-bug-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 6: Width Bug Fix
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-7-region-alignment-and-bin-constraint-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 7: Region Alignment and Bin Constraint Fix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stage 7: Region Alignment and Bin Constraint Fix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fix-1-gridcell-based-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix 1: Gridcell-Based Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-2-mandatory-2m-hand-bin-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix 2: Mandatory 2m HAND Bin Constraint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-3-spherical-pixel-area-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix 3: Spherical Pixel Area Calculation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-8-gradient-calculation-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 8: Gradient Calculation Fix
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-9-accumulation-threshold-sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 9: Accumulation Threshold Sensitivity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Final Results
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#area-discrepancy-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Area Discrepancy Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-bugs-found-and-fixed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary of Bugs Found and Fixed
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../osbs-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OSBS Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/modifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fork Modifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    External Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../archive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-1-pgrid-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 1: pgrid Validation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-2-fft-spatial-scale-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 2: FFT Spatial Scale Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-3-hillslope-parameter-computation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 3: Hillslope Parameter Computation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-4-initial-comparison-to-published-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 4: Initial Comparison to Published Data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-5-unit-conversion-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 5: Unit Conversion Fix
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-6-width-bug-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 6: Width Bug Fix
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-7-region-alignment-and-bin-constraint-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 7: Region Alignment and Bin Constraint Fix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stage 7: Region Alignment and Bin Constraint Fix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fix-1-gridcell-based-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix 1: Gridcell-Based Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-2-mandatory-2m-hand-bin-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix 2: Mandatory 2m HAND Bin Constraint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-3-spherical-pixel-area-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fix 3: Spherical Pixel Area Calculation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-8-gradient-calculation-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 8: Gradient Calculation Fix
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-9-accumulation-threshold-sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stage 9: Accumulation Threshold Sensitivity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Final Results
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#area-discrepancy-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Area Discrepancy Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-bugs-found-and-fixed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary of Bugs Found and Fixed
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="merit-dem-validation">MERIT DEM Validation<a class="headerlink" href="#merit-dem-validation" title="Permanent link">&para;</a></h1>
<p><em>Validating the ported pysheds implementation against Swenson's published hillslope dataset using MERIT DEM data.</em></p>
<hr />
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Before applying the pipeline to OSBS LIDAR data, it was validated against Swenson's published global hillslope dataset (<code>hillslopes_0.9x1.25_c240416.nc</code>). The validation used a MERIT DEM tile (<code>n30w095_dem.tif</code>, 6000x6000 pixels, ~90m resolution) covering the same region as a published gridcell, allowing direct comparison of all six geomorphic parameters.</p>
<p>The validation proceeded through nine stages, each building on the previous and addressing specific problems as they were discovered.</p>
<hr />
<h2 id="stage-1-pgrid-validation">Stage 1: pgrid Validation<a class="headerlink" href="#stage-1-pgrid-validation" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Confirm that pysheds methods work on MERIT DEM at scale.</p>
<p>A full MERIT tile was loaded and processed through flow direction, accumulation, HAND, and DTND computation using a fixed accumulation threshold of 1000 cells.</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Result</th>
<th>Criterion</th>
</tr>
</thead>
<tbody>
<tr>
<td>DEM dimensions</td>
<td>6000 x 6000 pixels</td>
<td>--</td>
</tr>
<tr>
<td>Elevation range</td>
<td>-19.8 to 818.4 m</td>
<td>--</td>
</tr>
<tr>
<td>Stream coverage</td>
<td>2.17%</td>
<td>1-5%</td>
</tr>
<tr>
<td>HAND range</td>
<td>-54 to 619 m</td>
<td>0-500 m</td>
</tr>
<tr>
<td>DTND range</td>
<td>0 to 22.9 km</td>
<td>0-50 km</td>
</tr>
</tbody>
</table>
<p>All validation criteria passed. Processing completed in 3.4 minutes.</p>
<hr />
<h2 id="stage-2-fft-spatial-scale-analysis">Stage 2: FFT Spatial Scale Analysis<a class="headerlink" href="#stage-2-fft-spatial-scale-analysis" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Determine the characteristic length scale (Lc) for the MERIT tile.</p>
<p>FFT analysis of the DEM Laplacian was performed at multiple region sizes to confirm consistency:</p>
<table>
<thead>
<tr>
<th>Region Size</th>
<th>Lc (pixels)</th>
<th>Lc (meters)</th>
</tr>
</thead>
<tbody>
<tr>
<td>500 x 500</td>
<td>8.3</td>
<td>766</td>
</tr>
<tr>
<td>1000 x 1000</td>
<td>8.2</td>
<td>760</td>
</tr>
<tr>
<td>2000 x 2000</td>
<td>8.2</td>
<td>758</td>
</tr>
</tbody>
</table>
<p>The characteristic length scale was consistent across region sizes: <strong>Lc = 8.2 pixels (763 m)</strong>. The best-fit spectral model was lognormal in all cases. The derived accumulation threshold was <strong>34 cells</strong> (via Swenson's formula: A_thresh = 0.5 * Lc^2).</p>
<hr />
<h2 id="stage-3-hillslope-parameter-computation">Stage 3: Hillslope Parameter Computation<a class="headerlink" href="#stage-3-hillslope-parameter-computation" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Compute the six geomorphic parameters for all 16 hillslope elements (4 aspects x 4 elevation bins).</p>
<p>Using the data-driven accumulation threshold from Stage 2, the stream network was denser than Stage 1 (10.88% coverage vs 2.17%). HAND bin boundaries were computed as [0, 2, 5, 9.6, 80] m.</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Fraction</th>
<th>Width (m)</th>
<th>Lowest h/d</th>
<th>Highest h/d</th>
</tr>
</thead>
<tbody>
<tr>
<td>North</td>
<td>24.4%</td>
<td>271</td>
<td>0.6m / 121m</td>
<td>14.7m / 439m</td>
</tr>
<tr>
<td>East</td>
<td>27.2%</td>
<td>304</td>
<td>0.6m / 121m</td>
<td>14.8m / 432m</td>
</tr>
<tr>
<td>South</td>
<td>22.1%</td>
<td>263</td>
<td>0.6m / 93m</td>
<td>15.1m / 431m</td>
</tr>
<tr>
<td>West</td>
<td>26.2%</td>
<td>295</td>
<td>0.6m / 121m</td>
<td>15.0m / 419m</td>
</tr>
</tbody>
</table>
<p>All 16 elements were populated with physically reasonable values.</p>
<hr />
<h2 id="stage-4-initial-comparison-to-published-data">Stage 4: Initial Comparison to Published Data<a class="headerlink" href="#stage-4-initial-comparison-to-published-data" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Quantitative comparison of computed parameters to Swenson's published dataset.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Correlation</th>
<th>Relative Error</th>
<th>Assessment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Height</td>
<td>0.999</td>
<td>6.7%</td>
<td>Excellent</td>
</tr>
<tr>
<td>Slope</td>
<td>0.987</td>
<td>8.2%</td>
<td>Excellent</td>
</tr>
<tr>
<td>Distance</td>
<td>0.986</td>
<td>34.1%</td>
<td>Good correlation, systematic offset</td>
</tr>
<tr>
<td>Area</td>
<td>0.730</td>
<td>Large</td>
<td>Unit mismatch</td>
</tr>
<tr>
<td>Aspect</td>
<td>0.650</td>
<td>Large</td>
<td>Degrees vs radians</td>
</tr>
<tr>
<td>Width</td>
<td>0.090</td>
<td>41.3%</td>
<td>Poor -- requires investigation</td>
</tr>
</tbody>
</table>
<p>Height and slope showed excellent agreement, confirming that the HAND and flow routing implementation was correct. Three problems were identified: a degrees-vs-radians mismatch for aspect, an area unit discrepancy, and a systematic width calculation bug.</p>
<hr />
<h2 id="stage-5-unit-conversion-fix">Stage 5: Unit Conversion Fix<a class="headerlink" href="#stage-5-unit-conversion-fix" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Fix aspect and area unit mismatches.</p>
<ul>
<li><strong>Aspect:</strong> Converting from degrees to radians improved circular correlation from 0.65 to <strong>0.9996</strong>.</li>
<li><strong>Area:</strong> The relative distribution (fraction per bin) correlated at 0.73 despite an absolute scale difference of ~26,000x between m^2 and published units.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Width bug identified</p>
<p>During this stage, all elevation bins within each aspect were found to have identical width values -- a clear bug since widths should decrease from outlet toward ridge.</p>
</div>
<hr />
<h2 id="stage-6-width-bug-fix">Stage 6: Width Bug Fix<a class="headerlink" href="#stage-6-width-bug-fix" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Diagnose and fix the identical-width bug.</p>
<p><strong>Root cause:</strong> The width calculation used raw pixel areas instead of fitted trapezoidal areas. Swenson's method computes width from cumulative <em>fitted</em> areas using the trapezoidal plan form model:</p>
<ol>
<li>Compute area fraction from raw pixel counts</li>
<li>Set fitted_area = trap_area * area_fraction</li>
<li>Accumulate fitted areas for lower bins</li>
<li>Solve quadratic for lower edge distance</li>
<li>Evaluate width at lower edge: w = w_base + 2 * trap_slope * d</li>
</ol>
<p>A <code>quadratic()</code> solver was ported from Swenson's <code>geospatial_utils</code> and the width calculation was rewritten to use a two-pass approach: first collect raw areas, then compute widths from fitted areas.</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Before (identical)</th>
<th>After (varying)</th>
</tr>
</thead>
<tbody>
<tr>
<td>North</td>
<td>271, 271, 271, 271</td>
<td>271, 218, 177, 123</td>
</tr>
<tr>
<td>East</td>
<td>304, 304, 304, 304</td>
<td>304, 246, 201, 143</td>
</tr>
<tr>
<td>South</td>
<td>263, 263, 263, 263</td>
<td>263, 213, 175, 126</td>
</tr>
<tr>
<td>West</td>
<td>295, 295, 295, 295</td>
<td>295, 237, 195, 140</td>
</tr>
</tbody>
</table>
<p>Width correlation improved from <strong>0.09 to 0.97</strong>.</p>
<hr />
<h2 id="stage-7-region-alignment-and-bin-constraint-fix">Stage 7: Region Alignment and Bin Constraint Fix<a class="headerlink" href="#stage-7-region-alignment-and-bin-constraint-fix" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Fix two remaining sources of area fraction discrepancy.</p>
<h3 id="fix-1-gridcell-based-extraction">Fix 1: Gridcell-Based Extraction<a class="headerlink" href="#fix-1-gridcell-based-extraction" title="Permanent link">&para;</a></h3>
<p>The processed region (2000x2000 pixels, ~1.67deg x 1.67deg) had only ~42% spatial overlap with the published gridcell (0.9deg x 1.25deg). The mismatch was caused by extracting a centered region that did not align with the published grid boundaries.</p>
<p>The fix implemented explicit gridcell boundary configuration using rasterio window-based extraction:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">TARGET_GRIDCELL</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">93.1250</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">91.8750</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">32.0419</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mf">32.9843</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">}</span>
</code></pre></div>
<p>An expansion factor (1.5x) was used for flow routing to avoid edge effects, with extraction to exact gridcell boundaries after HAND/DTND computation.</p>
<h3 id="fix-2-mandatory-2m-hand-bin-constraint">Fix 2: Mandatory 2m HAND Bin Constraint<a class="headerlink" href="#fix-2-mandatory-2m-hand-bin-constraint" title="Permanent link">&para;</a></h3>
<p>The initial implementation treated the lowest HAND bin upper bound (2m) as optional. Swenson's code and the paper treat it as <strong>mandatory</strong>: "The upper bound of the lowest bin must be 2 m or less." The bin computation was rewritten to match Swenson's <code>SpecifyHandBounds()</code> algorithm, including per-aspect validation that each aspect has at least 1% of pixels below the bin1_max threshold.</p>
<h3 id="fix-3-spherical-pixel-area-calculation">Fix 3: Spherical Pixel Area Calculation<a class="headerlink" href="#fix-3-spherical-pixel-area-calculation" title="Permanent link">&para;</a></h3>
<p>The original pixel area calculation used a single cosine-weighted approximation. Swenson's method uses per-pixel spherical coordinates:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>A_pixel = R^2 * d_theta * d_phi * sin(theta)
</code></pre></div>
<p>where theta is colatitude (90deg - lat). After the fix, the total gridcell area matched published data to within 0.07%.</p>
<hr />
<h2 id="stage-8-gradient-calculation-fix">Stage 8: Gradient Calculation Fix<a class="headerlink" href="#stage-8-gradient-calculation-fix" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Investigate the remaining area fraction discrepancy (correlation 0.64).</p>
<p>Comparison of gradient methods revealed a <strong>North-South aspect swap</strong> affecting ~46% of pixels:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Classification transitions (our -&gt; pgrid):
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  North-&gt;South: 407,465 (24.1%)
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  South-&gt;North: 378,450 (22.4%)
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>  East/West: &lt;10 pixels total
</code></pre></div>
<p><strong>Root cause:</strong> The custom <code>np.gradient()</code> implementation had a Y-axis sign inversion due to coordinate system convention differences -- <code>np.gradient</code> row ordering does not match geographic north. East and West aspects were unaffected because the X-axis convention was consistent.</p>
<p><strong>Fix:</strong> Replaced the custom gradient function with pgrid's <code>slope_aspect()</code> method, which uses the Horn (1981) 8-neighbor stencil with correct geographic coordinate conventions.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Before Fix</th>
<th>After Fix</th>
</tr>
</thead>
<tbody>
<tr>
<td>Height</td>
<td>0.9994</td>
<td>0.9999</td>
</tr>
<tr>
<td>Distance</td>
<td>0.9967</td>
<td>0.9982</td>
</tr>
<tr>
<td><strong>Area Fraction</strong></td>
<td><strong>0.6374</strong></td>
<td><strong>0.8200</strong></td>
</tr>
<tr>
<td>Slope</td>
<td>0.9866</td>
<td>0.9966</td>
</tr>
<tr>
<td>Aspect (circular)</td>
<td>0.9996</td>
<td>0.9999</td>
</tr>
<tr>
<td>Width</td>
<td>0.9527</td>
<td>0.9597</td>
</tr>
</tbody>
</table>
<p>Area correlation improved from 0.64 to <strong>0.82</strong> -- a 28% improvement.</p>
<hr />
<h2 id="stage-9-accumulation-threshold-sensitivity">Stage 9: Accumulation Threshold Sensitivity<a class="headerlink" href="#stage-9-accumulation-threshold-sensitivity" title="Permanent link">&para;</a></h2>
<p><strong>Goal:</strong> Determine whether a different accumulation threshold could improve the remaining area discrepancy.</p>
<p>Five thresholds were tested:</p>
<table>
<thead>
<tr>
<th>Threshold (cells)</th>
<th>Correlation</th>
</tr>
</thead>
<tbody>
<tr>
<td>20</td>
<td>0.83</td>
</tr>
<tr>
<td><strong>34</strong> (baseline)</td>
<td><strong>0.80</strong></td>
</tr>
<tr>
<td>50</td>
<td>0.68</td>
</tr>
<tr>
<td>100</td>
<td>-0.01</td>
</tr>
<tr>
<td>200</td>
<td>-0.44</td>
</tr>
</tbody>
</table>
<p>The best correlation (0.83 at threshold=20) was only marginally better than the baseline. Higher thresholds degraded rapidly. The remaining ~17% unexplained variance was attributed to differences in DEM preprocessing, edge effects from spatial extent differences, and undocumented methodology differences in the published data.</p>
<hr />
<h2 id="final-results">Final Results<a class="headerlink" href="#final-results" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Correlation</th>
<th>Assessment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Height</td>
<td>0.9999</td>
<td>Excellent</td>
</tr>
<tr>
<td>Distance</td>
<td>0.9982</td>
<td>Excellent</td>
</tr>
<tr>
<td>Slope</td>
<td>0.9966</td>
<td>Excellent</td>
</tr>
<tr>
<td>Aspect</td>
<td>0.9999</td>
<td>Excellent</td>
</tr>
<tr>
<td>Width</td>
<td>0.9597</td>
<td>Excellent</td>
</tr>
<tr>
<td>Area</td>
<td>0.8200</td>
<td>Good</td>
</tr>
</tbody>
</table>
<p>Five of six parameters achieved &gt;0.95 correlation with Swenson's published data.</p>
<hr />
<h2 id="area-discrepancy-analysis">Area Discrepancy Analysis<a class="headerlink" href="#area-discrepancy-analysis" title="Permanent link">&para;</a></h2>
<p>Three potential causes of the area fraction discrepancy were investigated:</p>
<table>
<thead>
<tr>
<th>Cause</th>
<th>Impact</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Region/gridcell mismatch</td>
<td><strong>Primary</strong></td>
<td>Even after the Stage 7 fix, minor boundary differences remained. The southern extension of the processed region included low-lying terrain that inflated the lowest HAND bin for north-facing slopes.</td>
</tr>
<tr>
<td>HAND bin computation</td>
<td>Secondary</td>
<td>Differences in bin boundary rounding and per-aspect handling</td>
</tr>
<tr>
<td>Accumulation threshold</td>
<td>Minor</td>
<td>~2% sensitivity per 3x threshold change</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Why this is acceptable</p>
<p>Height, distance, slope, aspect, and width are all <em>means within bins</em> and are insensitive to small changes in bin boundaries. Area is the <em>total per bin</em>, making it more sensitive to bin boundary choices. The 0.82 correlation was considered sufficient to validate the methodology for OSBS, where custom data would be produced rather than replicated from the published dataset.</p>
</div>
<hr />
<h2 id="summary-of-bugs-found-and-fixed">Summary of Bugs Found and Fixed<a class="headerlink" href="#summary-of-bugs-found-and-fixed" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Stage</th>
<th>Bug</th>
<th>Root Cause</th>
<th>Fix</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>Aspect correlation 0.65</td>
<td>Degrees vs radians</td>
<td>Convert to radians for comparison</td>
</tr>
<tr>
<td>6</td>
<td>Width identical across bins</td>
<td>Raw pixel areas instead of fitted trapezoidal areas</td>
<td>Two-pass width calculation with <code>quadratic()</code> solver</td>
</tr>
<tr>
<td>7</td>
<td>Area 42% spatial overlap</td>
<td>Region not aligned to published gridcell</td>
<td>Explicit gridcell boundary extraction</td>
</tr>
<tr>
<td>7</td>
<td>Bin1 constraint ignored</td>
<td>Optional vs mandatory 2m threshold</td>
<td>Rewrote <code>compute_hand_bins()</code> per Swenson's algorithm</td>
</tr>
<tr>
<td>7</td>
<td>Pixel area approximation</td>
<td>Uniform cosine vs per-pixel spherical</td>
<td>Implemented Swenson's spherical area formula</td>
</tr>
<tr>
<td>8</td>
<td>N/S aspect swap</td>
<td>Y-axis sign inversion in np.gradient</td>
<td>Switched to pgrid's Horn (1981) method</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../pysheds-porting/" class="md-footer__link md-footer__link--prev" aria-label="Previous: pysheds Porting">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                pysheds Porting
              </div>
            </div>
          </a>
        
        
          
          <a href="../osbs-implementation/" class="md-footer__link md-footer__link--next" aria-label="Next: OSBS Implementation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                OSBS Implementation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>